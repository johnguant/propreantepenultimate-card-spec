# Propreantepenultimate Card Specification

Game State consists of the current active player (initially one to the left of the dealer), integers AV (attack value) (initially 0), MV (move value) (0) and booleans CW (clockwise) (true), FC (first card this turn) (true), RM (require suit / rank matches) (true), B (bridging 3s and 7s) (false) and PW (prevent wins) (false). Now the top card from the pile is placed on the table. If that card has rank 2 or 5, set AV to that card’s rank. If the rank is 10, set MV to 1. If the rank is Jack, set MV to 1 & CW to false. If the rank is Ace, set RM to false.
The game then starts on step 1. Unless explained otherwise, follow the steps in order.

1. If PW is false and any player has an empty hand, they win the game. The player Max(0, MV) steps of the current active player becomes the new active player, clockwise if CW is true or otherwise counterclockwise. If MV is positive, set it to 0. Increment MV. Set FC to true and B to false.
2. The active player chooses one of the following options to play a card. If FC is false, the active player may only play a card if (1) it has the same rank as the topmost or the penultimate card, or (2) its rank is ±1 of the top or penultimate card’s rank, wrapping at Ace, or (3) it has rank 3 or 7, and the topmost or penultimate card has rank 7 or 3 respectively, and B is true, or (4) at least two cards have been played so far, the top two cards and the card to be played have a rank between 2 and 10 (inclusive), and the sum, difference, product or quotient of the ranks of two of the three cards (top two cards from the pile and the card to be played) in any order is an integer equal to the remaining card’s rank, or (5) it is an Ace of Spades being played on a top or penultimate card with a non-numeric rank; unless option (2) was selected, set RM to false. After the requirements of first sentence of the option text have been checked, RM, B and PW are reset to their initial values unless FC is false and option 1 was selected. Afterwards set FC to false and go to step 2 unless specified otherwise.
  1. Don't play a card. If FC is true, draw Max(1, AV) cards, set AV to 0 and PW to false. Go to step 1.
  2. FC must be true. Play your hand without restrictions or effects. Draw as many cards as you had before. Go to step 1.
  3. The card’s rank must be 2 or 5, and it can’t be the player’s last card. Increase AV by the card’s rank.
  4. The card’s rank must be 3 or 7, and either it’s not playable as the player’s last card or AV mustn’t be 0. Decrease AV by this card’s rank. If AV is 0 or less, set it to 0; otherwise set B to true. If the preceding card’s rank is different from this card’s rank, it is 3 or 7, and FC is false, the active player can choose to set AV to 0. If the active player now has no cards and AV is not 0, set PW to true and MV to 0.
  5. The card’s rank must be 10, it mustn’t be the player’s last card, and, if RM is true, the rank or suit of this card must match. The active player chooses to either increase or decrease MV by 1.
  6. The card must be a Jack and not the player’s last card. Set CW to its inverse.
  7. The card must be an Ace, not the player’s last card, and AV must be 0. The player selects a suit to which this card’s suit changes.
  8. AV must be 0, if the two topmost cards both have rank 6 this card's mustn't have rank 6, and, if RM is true, the rank or suit of this card must match except if this card is a Queen of Hearts, in which case it can be played on any King, or if it is a King of Hearts, in which case it can be played on any Queen. If a card with rank between 2 and 10 (inclusive) is played horizontally, it's rank is set to 11 minus the card's original rank.

Any player that says “Last Card” must draw a card. A player can only play their last card if they said the name of this game before the previous active player finished their last turn.
